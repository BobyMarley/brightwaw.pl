# 🔐 Распределение ролей и прав доступа

## 👥 Роли в системе:

| Роль | Определение | Доступ |
|------|-------------|--------|
| **👨‍💼 Админ** | Email НЕ найден в коллекции `workers` | Полный доступ ко всем разделам |
| **👷 Работник** | Email найден в коллекции `workers` | Только свой кабинет |

---

## 📋 Что видит каждая роль:

### 👨‍💼 **АДМИН (Менеджер)**

#### Меню:
- ✅ **Обзор** - главная страница админки
- ✅ **Заказы** - управление всеми заказами
- ✅ **Работники** - управление командой
- ✅ **Календарь** - общий календарь доступности

#### Функции:
- ✅ Просмотр и редактирование всех заказов
- ✅ Создание/редактирование/удаление работников
- ✅ Создание аккаунтов для работников
- ✅ Просмотр расписания всех работников
- ✅ Экспорт расписаний в Excel
- ✅ Управление календарем доступности
- ✅ Полный доступ к Firebase данным

---

### 👷 **РАБОТНИК**

#### Меню:
- ✅ **Мой кабинет** - единственная доступная страница

#### Что видит в кабинете:
- ✅ **Свой профиль**: фото, имя, должность, стаж, контакты
- ✅ **Статистику работы**: дни и часы за месяц
- ✅ **Календарь расписания**: выбор дней и времени работы
- ✅ **Кнопку сохранения** расписания

#### Ограничения:
- ❌ НЕ видит заказы клиентов
- ❌ НЕ видит других работников
- ❌ НЕ может управлять системой
- ❌ НЕ может экспортировать данные
- ❌ НЕ видит общий календарь

---

## 🔧 Как создать аккаунт работнику:

### Способ 1: Через админ-панель (НОВЫЙ)
1. Админ заходит в **"Работники"**
2. Находит нужного работника
3. Нажимает **"Создать аккаунт"**
4. Вводит пароль (по умолчанию: 123456)
5. Система создает аккаунт в Firebase
6. Админ сообщает данные работнику

### Способ 2: Вручную через Firebase Console
1. Заходим в Firebase Console → Authentication
2. Нажимаем "Add user"
3. Вводим email работника (тот же что в профиле)
4. Задаем пароль
5. Сохраняем

---

## 🎯 Логика определения ролей:

```javascript
// В AuthContext.tsx
const getUserRole = async (email: string) => {
    // Ищем email в коллекции workers
    const workersRef = collection(db, 'workers');
    const workerQuery = query(workersRef, where('email', '==', email));
    const workerSnapshot = await getDocs(workerQuery);
    
    // Если найден - работник, если нет - админ
    return workerSnapshot.empty ? 'admin' : 'worker';
};
```

---

## 🔒 Защита маршрутов:

| Маршрут | Админ | Работник |
|---------|-------|----------|
| `/` | ✅ Админ дашборд | ✅ Кабинет работника |
| `/orders` | ✅ Доступен | ❌ Заблокирован |
| `/workers` | ✅ Доступен | ❌ Заблокирован |
| `/calendar` | ✅ Доступен | ❌ Заблокирован |

---

## 📱 Интерфейс по ролям:

### Админ видит:
```
┌─────────────────────────────────┐
│ BrightHouse Control Panel       │
├─────────────────────────────────┤
│ 📊 Обзор                        │
│ 📋 Заказы                       │
│ 👥 Работники                    │
│ 📅 Календарь                    │
│ 🚪 Выход                        │
└─────────────────────────────────┘
```

### Работник видит:
```
┌─────────────────────────────────┐
│ BrightHouse Control Panel       │
├─────────────────────────────────┤
│ 👤 Мой кабинет                  │
│ 🚪 Выход                        │
└─────────────────────────────────┘
```

---

## ⚡ Быстрый старт:

### Для админа:
1. Заходим на `/admin-panel/`
2. Вводим админский email/пароль
3. Видим полную админку

### Для работника:
1. Админ создает профиль работника с email
2. Админ нажимает "Создать аккаунт" → задает пароль
3. Работник заходит на `/admin-panel/` со своими данными
4. Видит только свой кабинет

---

## 🛡️ Безопасность:

- ✅ **Автоматическое определение ролей** по email
- ✅ **Защита маршрутов** через RoleGuard
- ✅ **Блокировка админских функций** для работников
- ✅ **Изоляция данных** - работник видит только свои данные
- ✅ **Firebase Rules** должны дополнительно ограничивать доступ

---

*Система автоматически определяет роль и показывает соответствующий интерфейс!* 🎉